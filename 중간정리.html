<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multimodal Stock Analysis: Interactive Report</title>
    <!-- 
        ë³´ê³ ì„œ ì›ë³¸: [Research] Multimodal Stock Analysis: Polygon + FinBERT + SHAP
        ëŒ€í™”í˜• ë³€í™˜: Gemini
    -->
    
    <!-- Placeholder Comments -->
    <!-- Chosen Palette: Calm Research (Stone neutrals with Blue/Orange accents) -->
    <!-- Application Structure Plan: A tabbed SPA (Overview, Data, Model, SHAP Analysis, Config). This structure mirrors the research process, guiding the user from the high-level goal to the raw data, the model, and finally the core findings (SHAP). This is more intuitive for exploration than a linear report. Key interaction is the Ticker selection in the 'Data' tab, which updates price/sentiment charts, directly showing the multimodal input. -->
    <!-- Visualization & Content Choices:
        - Report Info: Price/Sentiment data -> Goal: Compare inputs -> Viz: Two separate, synced line charts (Chart.js) -> Interaction: Ticker Dropdown -> Justification: Clearly separates and visualizes the two data modalities.
        - Report Info: Training Loss -> Goal: Show model learning -> Viz: Line Chart (Chart.js) -> Justification: Standard way to show model convergence.
        - Report Info: SHAP Groupings (Chart vs News) -> Goal: Show core finding over time -> Viz: Stacked Bar Chart (Chart.js) -> Justification: Directly answers the report's main question (which factor was more dominant, and when).
        - Report Info: SHAP Feature Importance -> Goal: Show key drivers -> Viz: Horizontal Bar Chart (Chart.js) -> Justification: Recreates a SHAP summary plot without Python.
        - Report Info: Hydra Configs -> Goal: Show experiment setup -> Viz: HTML <pre> tag -> Justification: Clearly shows the "config-as-code" principle from the report.
        - Library: Chart.js (Canvas-based). -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* Tailwindì˜ Inter í°íŠ¸ ê¸°ë³¸ ì ìš© */
        body { font-family: 'Inter', sans-serif; }
        
        /* í™œì„± íƒ­ ìŠ¤íƒ€ì¼ */
        .tab-button.active {
            border-bottom-color: #2563EB; /* blue-600 */
            color: #2563EB;
            font-weight: 600;
        }
        
        /* ë¹„í™œì„± íƒ­ ìŠ¤íƒ€ì¼ */
        .tab-button {
            border-bottom: 2px solid transparent;
            color: #6B7280; /* gray-500 */
        }
        
        /* ì„¹ì…˜ ìˆ¨ê¹€ ì²˜ë¦¬ */
        .tab-section { display: none; }
        .tab-section.active { display: block; }

        /* Chart.js ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ (ëª…ì„¸ì„œ ìš”êµ¬ì‚¬í•­ ì¤€ìˆ˜) */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px; /* ë” ë„“ì€ ëŒ€ì‹œë³´ë“œë¥¼ ìœ„í•´ 800pxë¡œ ì„¤ì • */
            margin-left: auto;
            margin-right: auto;
            height: 350px; /* ê¸°ë³¸ ë†’ì´ */
            max-height: 400px;
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        
        /* Hydra config ì½”ë“œ ë¸”ë¡ ìŠ¤íƒ€ì¼ */
        pre {
            background-color: #1F2937; /* gray-900 */
            color: #E5E7EB; /* gray-200 */
            padding: 1rem;
            border-radius: 0.5rem; /* rounded-lg */
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
        }
        
        .icon {
            font-size: 1.5rem;
            margin-right: 0.5rem;
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-800">

    <div class="max-w-7xl mx-auto p-4 md:p-8">
        
        <!-- 1. í—¤ë” -->
        <header class="mb-8 pb-4 border-b border-stone-200">
            <h1 class="text-3xl md:text-4xl font-bold text-blue-900">Multimodal Stock Analysis: Interactive Report</h1>
            <p class="text-lg text-stone-600 mt-2">Polygon.io, FinBERT, and SHAP Explanations</p>
        </header>

        <!-- 2. ë„¤ë¹„ê²Œì´ì…˜ íƒ­ -->
        <nav class="flex border-b-2 border-stone-200 mb-8 space-x-4 md:space-x-8">
            <button class="tab-button active py-3 px-1 md:px-4 text-sm md:text-base" data-tab="overview">
                <span class="icon">ğŸ </span>Overview
            </button>
            <button class="tab-button py-3 px-1 md:px-4 text-sm md:text-base" data-tab="data">
                <span class="icon">ğŸ“Š</span>Data Pipeline
            </button>
            <button class="tab-button py-3 px-1 md:px-4 text-sm md:text-base" data-tab="model">
                <span class="icon">ğŸ§ </span>Model & Training
            </button>
            <button class="tab-button py-3 px-1 md:px-4 text-sm md:text-base" data-tab="shap">
                <span class="icon">ğŸ’¡</span>SHAP Analysis
            </button>
            <button class="tab-button py-3 px-1 md:px-4 text-sm md:text-base" data-tab="config">
                <span class="icon">âš™ï¸</span>Configuration
            </button>
        </nav>

        <!-- 3. ì»¨í…ì¸  ì„¹ì…˜ -->
        <main>
            <!-- 3.1. Overview ì„¹ì…˜ -->
            <section id="overview" class="tab-section active">
                <h2 class="text-2xl font-bold text-stone-900 mb-4">1. í”„ë¡œì íŠ¸ ê°œìš”</h2>
                <div class="space-y-4 text-stone-700 text-base md:text-lg leading-relaxed">
                    <p>ë³¸ í”„ë¡œì íŠ¸ëŠ” ë¯¸êµ­ ì£¼ì‹ ì‹œì¥(ì˜ˆ: META, GOOGL)ì„ ëŒ€ìƒìœ¼ë¡œ, ì •í˜• ë°ì´í„°(ì£¼ê°€ ì°¨íŠ¸)ì™€ ë¹„ì •í˜• ë°ì´í„°(ë‰´ìŠ¤ ì„¼í‹°ë©˜íŠ¸)ë¥¼ ê²°í•©í•œ ë©€í‹°ëª¨ë‹¬(Multimodal) ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.</p>
                    <p class="font-semibold text-blue-800">
                        í•µì‹¬ ëª©í‘œëŠ” ë‹¨ìˆœí•œ ì˜ˆì¸¡ ì •í™•ë„ë¥¼ ë„˜ì–´, SHAP(SHapley Additive exPlanations)ì„ í†µí•´ ì£¼ê°€ ë³€ë™ì˜ í•µì‹¬ ë™ì¸(Key Driver)ì´ ê¸°ìˆ ì  ìš”ì¸(Chart)ì¸ì§€, ì•„ë‹ˆë©´ ì‹œì¥ ì‹¬ë¦¬(News)ì¸ì§€ë¥¼ ì‹œê³„ì—´ì ìœ¼ë¡œ ë¶„ë¦¬í•˜ê³  í•´ì„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
                    </p>
                </div>
                <div class="mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-stone-200">
                        <h3 class="text-xl font-semibold mb-2 text-blue-900">Data Acquisition</h3>
                        <p class="text-stone-600">Polygon.io (ì£¼ê°€, ê³¼ê±° ë‰´ìŠ¤)<br>Tavily AI (ì‹¬ì¸µ ë¶„ì„)</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-stone-200">
                        <h3 class="text-xl font-semibold mb-2 text-blue-900">NLP Model</h3>
                        <p class="text-stone-600"><code>ProsusAI/finbert</code> (ê¸ˆìœµ íŠ¹í™” ê°ì„± ë¶„ì„)</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-stone-200">
                        <h3 class="text-xl font-semibold mb-2 text-blue-900">Explainability (XAI)</h3>
                        <p class="text-stone-600"><code>shap</code> (GradientExplainer)<br>PyTorch (LSTM / GRU)</p>
                    </div>
                </div>
            </section>

            <!-- 3.2. Data Pipeline ì„¹ì…˜ -->
            <section id="data" class="tab-section">
                <h2 class="text-2xl font-bold text-stone-900 mb-4">2. ëŒ€í™”í˜• ë°ì´í„° íŒŒì´í”„ë¼ì¸</h2>
                <p class="text-stone-700 mb-6">ëª¨ë¸ì˜ ë‘ ê°€ì§€ ì£¼ìš” ì…ë ¥ì¸ 'ì£¼ê°€'ì™€ 'ë‰´ìŠ¤ ê°ì„±'ì„ ì‹œê°ì ìœ¼ë¡œ íƒìƒ‰í•©ë‹ˆë‹¤. ì¢…ëª©ì„ ì„ íƒí•˜ì—¬ ë‘ ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì´ ì‹œê°„ì— ë”°ë¼ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</p>
                
                <div class="mb-6 max-w-xs">
                    <label for="tickerSelect" class="block text-sm font-medium text-stone-700 mb-2">ì¢…ëª© ì„ íƒ:</label>
                    <select id="tickerSelect" class="w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <option value="META" selected>META (Meta Platforms, Inc.)</option>
                        <option value="GOOGL">GOOGL (Alphabet Inc.)</option>
                    </select>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white p-4 rounded-lg shadow-lg border border-stone-200">
                        <h3 class="text-xl font-semibold mb-4 text-center text-stone-800">Chart Input: ì£¼ê°€(ì¢…ê°€) ì¶”ì´</h3>
                        <div class="chart-container">
                            <canvas id="priceChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-lg border border-stone-200">
                        <h3 class="text-xl font-semibold mb-4 text-center text-stone-800">News Input: FinBERT ê°ì„± ì ìˆ˜ ì¶”ì´</h3>
                        <div class="chart-container">
                            <canvas id="sentimentChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 3.3. Model & Training ì„¹ì…˜ -->
            <section id="model" class="tab-section">
                <h2 class="text-2xl font-bold text-stone-900 mb-4">3. ëª¨ë¸ ë° í•™ìŠµ ê³¼ì •</h2>
                <p class="text-stone-700 mb-6">ë³¸ ì—°êµ¬ëŠ” PyTorch ê¸°ë°˜ì˜ LSTM(Long Short-Term Memory) ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ëª¨ë¸ì€ ì°¨íŠ¸ ë°ì´í„°ì™€ ë‰´ìŠ¤ ê°ì„± ì ìˆ˜ë¥¼ í¬í•¨í•œ ë‹¤ì¤‘ í”¼ì²˜ë¥¼ ì…ë ¥ë°›ì•„ ì‹œê³„ì—´ íŒ¨í„´ì„ í•™ìŠµí•©ë‹ˆë‹¤.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-stone-200">
                        <h3 class="text-xl font-semibold mb-4 text-center text-stone-800">ëª¨ë¸ ì•„í‚¤í…ì²˜ (ê°œë…)</h3>
                        <div class="space-y-4">
                            <div class="flex items-center p-4 bg-blue-50 rounded-lg border border-blue-200">
                                <span class="icon">ğŸ“ˆ</span>
                                <div>
                                    <h4 class="font-semibold">Chart Features</h4>
                                    <p class="text-sm text-stone-600">(OHLCV, RSI, MACD...)</p>
                                </div>
                            </div>
                            <div class="flex items-center p-4 bg-orange-50 rounded-lg border border-orange-200">
                                <span class="icon">ğŸ“°</span>
                                <div>
                                    <h4 class="font-semibold">News Feature</h4>
                                    <p class="text-sm text-stone-600">(Sentiment Score)</p>
                                </div>
                            </div>
                            <div class="text-center text-2xl font-bold text-stone-500">â†“</div>
                            <div class="flex items-center justify-center p-6 bg-stone-100 rounded-lg border border-stone-300">
                                <span class="icon">ğŸ§ </span>
                                <h4 class="text-lg font-semibold">Multimodal LSTM Core</h4>
                            </div>
                            <div class="text-center text-2xl font-bold text-stone-500">â†“</div>
                            <div class="flex items-center justify-center p-4 bg-green-50 rounded-lg border border-green-200">
                                <span class="icon">ğŸ’°</span>
                                <h4 class="text-lg font-semibold">Price Prediction (t+1)</h4>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-lg border border-stone-200">
                        <h3 class="text-xl font-semibold mb-4 text-center text-stone-800">ëª¨ë¸ í•™ìŠµ ì†ì‹¤ (ê°€ìƒ)</h3>
                        <p class="text-sm text-center text-stone-600 mb-4">Epochê°€ ì§„í–‰ë¨ì— ë”°ë¼ ëª¨ë¸ì˜ ì†ì‹¤(MSE)ì´ ê°ì†Œí•˜ë©° ìˆ˜ë ´í•˜ëŠ” ê³¼ì •ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
                        <div class="chart-container">
                            <canvas id="lossChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 3.4. SHAP Analysis ì„¹ì…˜ -->
            <section id="shap" class="tab-section">
                <h2 class="text-2xl font-bold text-stone-900 mb-4">4. í•µì‹¬ ë¶„ì„: SHAP ì˜í–¥ë ¥ í•´ì„</h2>
                <p class="text-stone-700 mb-6">ì´ ì„¹ì…˜ì€ ë³¸ ì—°êµ¬ì˜ í•µì‹¬ ê²°ê³¼ì…ë‹ˆë‹¤. SHAP ë¶„ì„ì„ í†µí•´ ëª¨ë¸ì˜ ì˜ˆì¸¡ì´ 'ì°¨íŠ¸ ê¸°ìˆ ì  ìš”ì¸'ê³¼ 'ë‰´ìŠ¤ ê°ì„± ìš”ì¸' ì¤‘ ì–´ëŠ ê²ƒì— ë” í¬ê²Œ ì˜ì¡´í–ˆëŠ”ì§€ ì‹œê³„ì—´ë¡œ ë¶„í•´í•©ë‹ˆë‹¤.</p>

                <div class="bg-white p-4 rounded-lg shadow-lg border border-stone-200 mb-8">
                    <h3 class="text-xl font-semibold mb-4 text-center text-stone-800">ì¼ë³„ ì˜í–¥ë ¥ ê¸°ì—¬ë„ (Chart vs News) - META (ê°€ìƒ)</h3>
                    <p class="text-sm text-center text-stone-600 mb-4">
                        ì£¼ê°€ ë³€ë™ ì˜ˆì¸¡ì— ëŒ€í•œ ì¼ë³„ SHAP ê°’ì˜ ì´í•©ì„ 'Chart' ê·¸ë£¹ê³¼ 'News' ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ìŒ“ì•˜ìŠµë‹ˆë‹¤.<br>
                        <span class="font-semibold text-blue-600">íŒŒë€ìƒ‰(Chart)</span>ì´ ë†’ìœ¼ë©´ ê¸°ìˆ ì  ë¶„ì„ì´, <span class="font-semibold text-orange-600">ì£¼í™©ìƒ‰(News)</span>ì´ ë†’ìœ¼ë©´ ì‹œì¥ ì‹¬ë¦¬ê°€ ì£¼ë„í•œ ë‚ ì…ë‹ˆë‹¤.
                    </p>
                    <div class="chart-container">
                        <canvas id="shapImpactChart"></canvas>
                    </div>
                </div>
                
                <div class="bg-white p-4 rounded-lg shadow-lg border border-stone-200">
                    <h3 class="text-xl font-semibold mb-4 text-center text-stone-800">ì „ì²´ ê¸°ê°„ í”¼ì²˜ ì¤‘ìš”ë„ (SHAP ìš”ì•½)</h3>
                    <p class="text-sm text-center text-stone-600 mb-4">ì „ì²´ í…ŒìŠ¤íŠ¸ ê¸°ê°„ ë™ì•ˆ í‰ê· ì ì¸ SHAP ì ˆëŒ€ê°’ (ì˜í–¥ë ¥)ì´ ë†’ì•˜ë˜ í”¼ì²˜ë“¤ì…ë‹ˆë‹¤.</p>
                    <div class="chart-container" style="height: 450px; max-height: 500px;">
                        <canvas id="shapSummaryChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- 3.5. Configuration ì„¹ì…˜ -->
            <section id="config" class="tab-section">
                <h2 class="text-2xl font-bold text-stone-900 mb-4">5. Hydra ì‹¤í—˜ ì„¤ì •</h2>
                <p class="text-stone-700 mb-6">ë³¸ ì—°êµ¬ëŠ” <code>hydra-core</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ì‹¤í—˜ì„ ì¬í˜„ ê°€ëŠ¥í•˜ë„ë¡ ê´€ë¦¬í•©ë‹ˆë‹¤. ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  YAML ì„¤ì • íŒŒì¼ì„ í†µí•´ íŒŒë¼ë¯¸í„°ë¥¼ ì œì–´í•©ë‹ˆë‹¤.</p>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-xl font-semibold mb-3">ë©”ì¸ ì„¤ì • (config.yaml)</h3>
                        <pre><code># config/config.yaml
defaults:
  - data: polygon
  - model: lstm
  - _self_

project_name: "MultimodalStockSHAP"
run_name: "default_run_${now:%Y-%m-%d_%H-%M-%S}"

main:
  seed: 42
  hydra_job_dir: "${hydra:runtime.cwd}/outputs/${run_name}"

api_keys:
  polygon: ${oc.env:POLYGON_API_KEY}
  tavily: ${oc.env:TAVILY_API_KEY}

training:
  batch_size: 32
  epochs: 50
  learning_rate: 0.001
  test_split_ratio: 0.15
</code></pre>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold mb-3">ë°ì´í„° ì„¤ì • (data/polygon.yaml)</h3>
                        <pre><code># config/data/polygon.yaml
name: polygon_dataset
tickers: ["META", "GOOGL"]
start_date: "2023-01-01"
end_date: "2025-01-01"
window_size: 20

missing_news_strategy: 'zero'

technical_indicators:
  - "RSI"
  - "MACD"
  - "BBANDS"
</code></pre>
                        <h3 class="text-xl font-semibold mb-3 mt-6">ëª¨ë¸ ì„¤ì • (model/lstm.yaml)</h3>
                        <pre><code># config/model/lstm.yaml
name: "lstm"
hidden_size: 64
num_layers: 2
dropout: 0.2
</code></pre>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            
            // --- [ë°ì´í„° ì£¼ì… ì§€ì ] ---
            // Colabì—ì„œ ì‹¤í–‰í•œ ì‹¤ì œ ë°ì´í„°ë¥¼ ì´ ê³³ì— JSON í˜•ì‹ìœ¼ë¡œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.
            // ì´ ê°’ì´ nullì´ë©´, ì•„ë˜ì˜ ê°€ìƒ ë°ì´í„°(generateMockData)ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.
            // 
            // 1. Python (Pandas)ì—ì„œ: 
            //    df_shap_impact.to_json(orient='records')
            //    df_summary.to_json(orient='split')
            //    ... ë“±ìœ¼ë¡œ ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë³€í™˜í•˜ì„¸ìš”.
            // 2. ê·¸ JSON ë¬¸ìì—´ì„ ì´ `null` ìë¦¬ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.
            //    (ì˜ˆ: window.REAL_DATA = { ...JSON ë‚´ìš©... };)
            // 
            // [í•„ìš”í•œ ë°ì´í„° í˜•ì‹]
            // window.REAL_DATA = {
            //     dates: ["2024-01-01", "2024-01-02", ...], // í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ ë‚ ì§œ ë°°ì—´
            //     META: {
            //         price: [300, 301, ...], // ì‹¤ì œ ì¢…ê°€
            //         sentiment: [0.1, -0.2, ...] // ì‹¤ì œ ê°ì„± ì ìˆ˜
            //     },
            //     GOOGL: { /* GOOGL ë°ì´í„° (ë™ì¼ í˜•ì‹) */ },
            //     loss: [1.5, 1.4, ...], // Epochë³„ ì‹¤ì œ Loss
            //     shap: { 
            //         // ì¼ë³„ ì˜í–¥ë ¥ (shapImpactChart) - datesì™€ ê¸¸ì´ê°€ ê°™ì•„ì•¼ í•¨
            //         chart: [0.5, 0.6, ...], // (shap_impact_analysis.csv ì—ì„œ ì¶”ì¶œ)
            //         news: [0.2, 0.1, ...]  // (shap_impact_analysis.csv ì—ì„œ ì¶”ì¶œ)
            //     },
            //     shapSummary: {
            //         // í”¼ì²˜ ì¤‘ìš”ë„ (shapSummaryChart)
            //         labels: ['Sentiment', 'Close', 'RSI', ...],
            //         importance: [0.45, 0.38, 0.25, ...]
            //     }
            // };
            window.REAL_DATA = null; 
            
            // --- ì „ì—­ ì°¨íŠ¸ ê°ì²´ ì €ì¥ì†Œ ---
            const charts = {
                price: null,
                sentiment: null,
                loss: null,
                shapImpact: null,
                shapSummary: null
            };

            // --- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ ë¡œì§ ---
            const tabButtons = document.querySelectorAll(".tab-button");
            const tabSections = document.querySelectorAll(".tab-section");

            tabButtons.forEach(button => {
                button.addEventListener("click", () => {
                    const tabName = button.getAttribute("data-tab");

                    // ë²„íŠ¼ í™œì„± ìƒíƒœ ë³€ê²½
                    tabButtons.forEach(btn => btn.classList.remove("active"));
                    button.classList.add("active");

                    // ì„¹ì…˜ í™œì„± ìƒíƒœ ë³€ê²½
                    tabSections.forEach(section => {
                        if (section.id === tabName) {
                            section.classList.add("active");
                        } else {
                            section.classList.remove("active");
                        }
                    });
                    
                    // í™œì„±í™”ëœ íƒ­ì— ë”°ë¼ ì°¨íŠ¸ ì´ˆê¸°í™” (ì¤‘ë³µ ë°©ì§€)
                    switch(tabName) {
                        case 'data':
                            initDataCharts('META'); // ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”
                            break;
                        case 'model':
                            initLossChart();
                            break;
                        case 'shap':
                            initShapImpactChart();
                            initShapSummaryChart();
                    break;
                    }
                });
            });
            
            // --- Ticker ì„ íƒ ë¡œì§ ---
            const tickerSelect = document.getElementById("tickerSelect");
            if (tickerSelect) {
                tickerSelect.addEventListener("change", (e) => {
                    initDataCharts(e.target.value);
                });
            }

            // --- ê°€ìƒ ë°ì´í„° ìƒì„±ê¸° ---
            function generateMockData() {
                const dates = Array.from({length: 60}, (_, i) => {
                    const date = new Date('2024-01-01');
                    date.setDate(date.getDate() + i * 7); // ì£¼ê°„ ë°ì´í„°
                    return date.toISOString().split('T')[0];
                });
                
                const generateSeries = (base, noise) => {
                    let val = base;
                    return dates.map(() => {
                        val += (Math.random() - 0.5) * noise;
                        return Math.max(0, val); // 0 ì´í•˜ ë°©ì§€
                    });
                };
                
                const generateSentiment = () => {
                    return dates.map(() => (Math.random() - 0.5) * 1.6); // -0.8 ~ 0.8
                };

                return {
                    dates,
                    META: {
                        price: generateSeries(300, 20),
                        sentiment: generateSentiment()
                    },
                    GOOGL: {
                        price: generateSeries(150, 10),
                        sentiment: generateSentiment()
                    },
                    loss: generateSeries(1.5, 0.1).map((d, i) => Math.max(0.1, d * Math.exp(-i * 0.1))),
                    shap: {
                        chart: generateSeries(0.5, 0.2),
                        news: generateSeries(0.2, 0.15)
                    },
                    shapSummary: {
                        labels: ['Sentiment', 'Close', 'RSI', 'Volume', 'MACD', 'BBANDS', 'Open', 'High'],
                        importance: [0.45, 0.38, 0.25, 0.22, 0.18, 0.15, 0.12, 0.10]
                    }
                };
            }
            
            // const mockData = generateMockData(); // <- ì´ ì¤„ì„ ìˆ˜ì •
            // REAL_DATAê°€ ìˆìœ¼ë©´ ê·¸ê²ƒì„ ì‚¬ìš©í•˜ê³ , ì—†ìœ¼ë©´ (nullì´ë©´) ê°€ìƒ ë°ì´í„°ë¥¼ ìƒì„±
            const mockData = window.REAL_DATA || generateMockData();

            // --- ì°¨íŠ¸ ë Œë”ë§ í•¨ìˆ˜ ---

            // ë°ì´í„° íŒŒì´í”„ë¼ì¸ ì°¨íŠ¸ (Price & Sentiment)
            function initDataCharts(ticker) {
                const data = mockData[ticker];
                const commonOptions = {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { 
                            ticks: { 
                                maxTicksLimit: 10,
                                // Chart.js 3+ ì—ì„œëŠ” autoSkipì´ ê¸°ë³¸
                            } 
                        }
                    },
                    plugins: { tooltip: { mode: 'index', intersect: false } }
                };

                // Price Chart
                if (charts.price) charts.price.destroy();
                const priceCtx = document.getElementById('priceChart').getContext('2d');
                charts.price = new Chart(priceCtx, {
                    type: 'line',
                    data: {
                        labels: mockData.dates,
                        datasets: [{
                            label: `${ticker} ì¢…ê°€`,
                            data: data.price,
                            borderColor: 'rgba(59, 130, 246, 1)', // blue-500
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            fill: true,
                            tension: 0.1
                        }]
                    },
                    options: { ...commonOptions, scales: { ...commonOptions.scales, y: { title: { display: true, text: 'Price ($)' } } } }
                });

                // Sentiment Chart
                if (charts.sentiment) charts.sentiment.destroy();
                const sentimentCtx = document.getElementById('sentimentChart').getContext('2d');
                charts.sentiment = new Chart(sentimentCtx, {
                    type: 'bar',
                    data: {
                        labels: mockData.dates,
                        datasets: [{
                            label: `${ticker} ê°ì„± ì ìˆ˜`,
                            data: data.sentiment,
                            backgroundColor: data.sentiment.map(d => d >= 0 ? 'rgba(249, 115, 22, 0.6)' : 'rgba(107, 114, 128, 0.6)'), // orange-500 / gray-500
                            borderColor: data.sentiment.map(d => d >= 0 ? 'rgba(249, 115, 22, 1)' : 'rgba(107, 114, 128, 1)'),
                            borderWidth: 1
                        }]
                    },
                    options: { ...commonOptions, scales: { ...commonOptions.scales, y: { title: { display: true, text: 'Sentiment Score (-1 to 1)' } } } }
                });
            }

            // ëª¨ë¸ í•™ìŠµ ì†ì‹¤ ì°¨íŠ¸
            function initLossChart() {
                if (charts.loss) return; // í•œ ë²ˆë§Œ ê·¸ë¦¼
                const lossCtx = document.getElementById('lossChart').getContext('2d');
                charts.loss = new Chart(lossCtx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: mockData.loss.length}, (_, i) => `Epoch ${i+1}`),
                        datasets: [{
                            label: 'Training MSE Loss',
                            data: mockData.loss,
                            borderColor: 'rgba(217, 70, 239, 1)', // fuchsia-500
                            backgroundColor: 'rgba(217, 70, 239, 0.1)',
                            fill: true,
                            tension: 0.1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: { y: { title: { display: true, text: 'MSE Loss' } } }
                    }
                });
            }

            // SHAP ì¼ë³„ ì˜í–¥ë ¥ ì°¨íŠ¸
            function initShapImpactChart() {
                if (charts.shapImpact) return; // í•œ ë²ˆë§Œ ê·¸ë¦¼
                const shapImpactCtx = document.getElementById('shapImpactChart').getContext('2d');
                charts.shapImpact = new Chart(shapImpactCtx, {
                    type: 'bar',
                    data: {
                        labels: mockData.dates,
                        datasets: [
                            {
                                label: 'Chart Impact',
                                data: mockData.shap.chart,
                                backgroundColor: 'rgba(59, 130, 246, 0.7)' // blue-500
                            },
                            {
                                label: 'News Impact',
                                data: mockData.shap.news,
                                backgroundColor: 'rgba(249, 115, 22, 0.7)' // orange-500
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: { stacked: true, ticks: { maxTicksLimit: 10 } },
                            y: { stacked: true, title: { display: true, text: 'SHAP Value (Absolute Sum)' } }
                        },
                        plugins: { tooltip: { mode: 'index' } }
                    }
                });
            }
            
            // SHAP ìš”ì•½ ì°¨íŠ¸
            function initShapSummaryChart() {
                if (charts.shapSummary) return; // í•œ ë²ˆë§Œ ê·¸ë¦¼
                const shapSummaryCtx = document.getElementById('shapSummaryChart').getContext('2d');
                charts.shapSummary = new Chart(shapSummaryCtx, {
                    type: 'bar', // ìˆ˜í‰ ë°” ì°¨íŠ¸
                    data: {
                        labels: mockData.shapSummary.labels,
                        datasets: [{
                            label: 'Mean Absolute SHAP Value',
                            data: mockData.shapSummary.importance,
                            backgroundColor: [
                                'rgba(249, 115, 22, 0.7)', // Sentiment (orange)
                                'rgba(59, 130, 246, 0.7)', // Close (blue)
                                'rgba(59, 130, 246, 0.6)',
                                'rgba(59, 130, 246, 0.5)',
                                'rgba(59, 130, 246, 0.4)',
                                'rgba(59, 130, 246, 0.3)',
                                'rgba(59, 130, 246, 0.2)',
                                'rgba(59, 130, 246, 0.1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y', // ì´ ì˜µì…˜ì´ ìˆ˜í‰ ë°” ì°¨íŠ¸ë¥¼ ë§Œë“­ë‹ˆë‹¤.
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: { title: { display: true, text: 'Mean Feature Importance (SHAP)' } }
                        },
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }

            // --- ì´ˆê¸°í™” ---
            // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ 'Overview' íƒ­ í™œì„±í™” (CSSì—ì„œ ì´ë¯¸ ì²˜ë¦¬)
            // ì‚¬ìš©ìê°€ ë‹¤ë¥¸ íƒ­ì„ í´ë¦­í•  ë•Œ í•´ë‹¹ ì°¨íŠ¸ê°€ ê·¸ë ¤ì§€ë„ë¡ ì„¤ì •
        });
    </script>
</body>
</html>